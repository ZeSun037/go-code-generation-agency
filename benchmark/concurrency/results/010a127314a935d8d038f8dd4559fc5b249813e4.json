{
    "task": "010a127314a935d8d038f8dd4559fc5b249813e4.txt",
    "provider": "anthropic",
    "model": "claude-haiku-4-5",
    "rounds": [
        {
            "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"sync\"\n\t\"time\"\n)\n\ntype ResourceUpdate struct {\n\tResourceType string\n\tResourceID   string\n\tUsageValue   float64\n}\n\ntype ResourceMonitor struct {\n\thighPriorityQueue chan ResourceUpdate\n\tlowPriorityQueue  chan ResourceUpdate\n\tresources         map[string]map[string]float64\n\tresourcesMu       sync.RWMutex\n\tmonitoredTypes    map[string]bool\n\ttypesMu           sync.RWMutex\n\tworkerWg          sync.WaitGroup\n\tstopChan          chan struct{}\n\treconfigMu        sync.Mutex\n\tisPaused          bool\n\tpauseCond         *sync.Cond\n\tactiveWorkers     int32\n\tactiveWorkersMu   sync.Mutex\n}\n\nfunc NewResourceMonitor(initialTypes []string, queueSize int) *ResourceMonitor {\n\trm := &ResourceMonitor{\n\t\thighPriorityQueue: make(chan ResourceUpdate, queueSize),\n\t\tlowPriorityQueue:  make(chan ResourceUpdate, queueSize),\n\t\tresources:         make(map[string]map[string]float64),\n\t\tmonitoredTypes:    make(map[string]bool),\n\t\tstopChan:          make(chan struct{}),\n\t\tisPaused:          false,\n\t}\n\n\trm.pauseCond = sync.NewCond(&rm.reconfigMu)\n\n\tfor _, t := range initialTypes {\n\t\trm.monitoredTypes[t] = true\n\t\trm.resources[t] = make(map[string]float64)\n\t}\n\n\treturn rm\n}\n\nfunc (rm *ResourceMonitor) StartWorkers(workersPerQueue int) {\n\tfor i := 0; i < workersPerQueue; i++ {\n\t\trm.workerWg.Add(1)\n\t\tgo rm.highPriorityWorker(i)\n\t}\n\n\tfor i := 0; i < workersPerQueue; i++ {\n\t\trm.workerWg.Add(1)\n\t\tgo rm.lowPriorityWorker(i)\n\t}\n\n\tfmt.Printf(\"Started %d high-priority workers and %d low-priority workers\\n\", workersPerQueue, workersPerQueue)\n}\n\nfunc (rm *ResourceMonitor) highPriorityWorker(id int) {\n\tdefer rm.workerWg.Done()\n\n\tfor {\n\t\tselect {\n\t\tcase <-rm.stopChan:\n\t\t\tfmt.Printf(\"High-priority worker %d shutting down\\n\", id)\n\t\t\treturn\n\t\tcase update := <-rm.highPriorityQueue:\n\t\t\trm.waitForReconfiguration()\n\t\t\trm.processUpdate(update, id, \"high-priority\")\n\t\t}\n\t}\n}\n\nfunc (rm *ResourceMonitor) lowPriorityWorker(id int) {\n\tdefer rm.workerWg.Done()\n\n\tfor {\n\t\tselect {\n\t\tcase <-rm.stopChan:\n\t\t\tfmt.Printf(\"Low-priority worker %d shutting down\\n\", id)\n\t\t\treturn\n\t\tcase update := <-rm.lowPriorityQueue:\n\t\t\trm.waitForReconfiguration()\n\t\t\trm.processUpdate(update, id, \"low-priority\")\n\t\t}\n\t}\n}\n\nfunc (rm *ResourceMonitor) waitForReconfiguration() {\n\trm.reconfigMu.Lock()\n\tfor rm.isPaused {\n\t\trm.pauseCond.Wait()\n\t}\n\trm.reconfigMu.Unlock()\n}\n\nfunc (rm *ResourceMonitor) processUpdate(update ResourceUpdate, workerID int, priority string) {\n\trm.typesMu.RLock()\n\tisMonitored := rm.monitoredTypes[update.ResourceType]\n\trm.typesMu.RUnlock()\n\n\tif !isMonitored {\n\t\tfmt.Printf(\"Ignoring update for unmonitored resource type: %s (worker %s-%d)\\n\",\n\t\t\tupdate.ResourceType, priority, workerID)\n\t\treturn\n\t}\n\n\trm.resourcesMu.Lock()\n\tif _, exists := rm.resources[update.ResourceType]; !exists {\n\t\trm.resources[update.ResourceType] = make(map[string]float64)\n\t}\n\trm.resources[update.ResourceType][update.ResourceID] = update.UsageValue\n\trm.resourcesMu.Unlock()\n\n\tfmt.Printf(\"[%s-worker-%d] Recorded %s:%s = %.2f%%\\n\",\n\t\tpriority, workerID, update.ResourceType, update.ResourceID, update.UsageValue)\n}\n\nfunc (rm *ResourceMonitor) SubmitHighPriorityUpdate(update ResourceUpdate) bool {\n\tselect {\n\tcase rm.highPriorityQueue <- update:\n\t\treturn true\n\tcase <-rm.stopChan:\n\t\treturn false\n\tdefault:\n\t\tfmt.Printf(\"High-priority queue full, skipping update for %s:%s\\n\",\n\t\t\tupdate.ResourceType, update.ResourceID)\n\t\treturn false\n\t}\n}\n\nfunc (rm *ResourceMonitor) SubmitLowPriorityUpdate(update ResourceUpdate) bool {\n\tselect {\n\tcase rm.lowPriorityQueue <- update:\n\t\treturn true\n\tcase <-rm.stopChan:\n\t\treturn false\n\tdefault:\n\t\tfmt.Printf(\"Low-priority queue full, skipping update for %s:%s\\n\",\n\t\t\tupdate.ResourceType, update.ResourceID)\n\t\treturn false\n\t}\n}\n\nfunc (rm *ResourceMonitor) Reconfigure(newTypes []string) {\n\tfmt.Println(\"\\n=== Starting reconfiguration ===\")\n\trm.reconfigMu.Lock()\n\trm.isPaused = true\n\trm.reconfigMu.Unlock()\n\n\ttime.Sleep(100 * time.Millisecond)\n\n\trm.typesMu.Lock()\n\trm.monitoredTypes = make(map[string]bool)\n\trm.resources = make(map[string]map[string]float64)\n\tfor _, t := range newTypes {\n\t\trm.monitoredTypes[t] = true\n\t\trm.resources[t] = make(map[string]float64)\n\t}\n\tfmt.Printf(\"Reconfigured to monitor: %v\\n\", newTypes)\n\trm.typesMu.Unlock()\n\n\trm.reconfigMu.Lock()\n\trm.isPaused = false\n\trm.pauseCond.Broadcast()\n\trm.reconfigMu.Unlock()\n\tfmt.Println(\"=== Reconfiguration complete, workers resumed ===\\n\")\n}\n\nfunc (rm *ResourceMonitor) Shutdown() {\n\tfmt.Println(\"\\nInitiating graceful shutdown...\")\n\tclose(rm.stopChan)\n\trm.workerWg.Wait()\n\tfmt.Println(\"All workers have shut down\")\n}\n\nfunc (rm *ResourceMonitor) GetResourceSnapshot() map[string]map[string]float64 {\n\trm.resourcesMu.RLock()\n\tdefer rm.resourcesMu.RUnlock()\n\n\tsnapshot := make(map[string]map[string]float64)\n\tfor resType, resources := range rm.resources {\n\t\tsnapshot[resType] = make(map[string]float64)\n\t\tfor resID, value := range resources {\n\t\t\tsnapshot[resType][resID] = value\n\t\t}\n\t}\n\treturn snapshot\n}\n\nfunc main() {\n\tfmt.Println(\"Resource Monitor with Dynamic Configuration Updates\")\n\tfmt.Println(\"=====================================================\\n\")\n\n\tinitialConfig := []string{\"CPU\", \"Memory\", \"Disk\"}\n\tmonitor := NewResourceMonitor(initialConfig, 20)\n\tmonitor.StartWorkers(5)\n\n\ttime.Sleep(500 * time.Millisecond)\n\n\tfmt.Println(\"--- Submitting initial resource updates ---\")\n\tfor i := 0; i < 15; i++ {\n\t\tresourceTypes := []string{\"CPU\", \"Memory\", \"Disk\"}\n\t\tresourceType := resourceTypes[i%len(resourceTypes)]\n\t\tresourceID := fmt.Sprintf(\"%s-%d\", resourceType, i/3)\n\t\tusageValue := float64(20+i*3) / 100\n\n\t\tif i%3 == 0 {\n\t\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t} else {\n\t\t\tmonitor.SubmitLowPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t}\n\t}\n\n\ttime.Sleep(1 * time.Second)\n\n\tfmt.Println(\"--- Snapshot after initial updates ---\")\n\tsnapshot := monitor.GetResourceSnapshot()\n\tfor resType, resources := range snapshot {\n\t\tfor resID, value := range resources {\n\t\t\tfmt.Printf(\"  %s:%s = %.2f%%\\n\", resType, resID, value)\n\t\t}\n\t}\n\n\tfmt.Println(\"\\n--- Submitting updates including unmonitored 'Network' type ---\")\n\tfor i := 0; i < 5; i++ {\n\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\tResourceType: \"Network\",\n\t\t\tResourceID:   fmt.Sprintf(\"eth%d\", i),\n\t\t\tUsageValue:   float64(30 + i*5),\n\t\t})\n\t}\n\n\ttime.Sleep(500 * time.Millisecond)\n\n\tnewConfig := []string{\"Memory\", \"Network\", \"Disk\"}\n\tmonitor.Reconfigure(newConfig)\n\n\tfmt.Println(\"--- Submitting updates after reconfiguration ---\")\n\tfor i := 0; i < 10; i++ {\n\t\tresourceTypes := []string{\"Memory\", \"Network\", \"Disk\"}\n\t\tresourceType := resourceTypes[i%len(resourceTypes)]\n\t\tresourceID := fmt.Sprintf(\"%s-new-%d\", resourceType, i)\n\t\tusageValue := float64(40+i*2) / 100\n\n\t\tif i%2 == 0 {\n\t\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t} else {\n\t\t\tmonitor.SubmitLowPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t}\n\t}\n\n\ttime.Sleep(1 * time.Second)\n\n\tfmt.Println(\"--- Final snapshot after reconfiguration and additional updates ---\")\n\tfinalSnapshot := monitor.GetResourceSnapshot()\n\tfor resType, resources := range finalSnapshot {\n\t\tfmt.Printf(\"%s:\\n\", resType)\n\t\tfor resID, value := range resources {\n\t\t\tfmt.Printf(\"  %s = %.2f%%\\n\", resID, value)\n\t\t}\n\t}\n\n\tmonitor.Shutdown()\n\tfmt.Println(\"\\nProgram complete\")\n}",
            "passed": false,
            "errors": [
                {
                    "verifier": "gosec",
                    "error": "Results:\n\n\n[\u001b[37;40m/tmp/go_synthesis_yvjkz9tm/main.go:256\u001b[0m] - G602 (CWE-118): slice index out of range (Confidence: HIGH, Severity: LOW)\n    255: \t\tresourceTypes := []string{\"Memory\", \"Network\", \"Disk\"}\n  > 256: \t\tresourceType := resourceTypes[i%len(resourceTypes)]\n    257: \t\tresourceID := fmt.Sprintf(\"%s-new-%d\", resourceType, i)\n\nAutofix: \n\n[\u001b[37;40m/tmp/go_synthesis_yvjkz9tm/main.go:210\u001b[0m] - G602 (CWE-118): slice index out of range (Confidence: HIGH, Severity: LOW)\n    209: \t\tresourceTypes := []string{\"CPU\", \"Memory\", \"Disk\"}\n  > 210: \t\tresourceType := resourceTypes[i%len(resourceTypes)]\n    211: \t\tresourceID := fmt.Sprintf(\"%s-%d\", resourceType, i/3)\n\nAutofix: \n\n\u001b[1;36mSummary:\u001b[0m\n  Gosec  : dev\n  Files  : 1\n  Lines  : 288\n  Nosec  : 0\n  Issues : \u001b[1;31m2\u001b[0m\n\n[gosec] 2025/12/01 11:25:04 Including rules: default\n[gosec] 2025/12/01 11:25:04 Excluding rules: default\n[gosec] 2025/12/01 11:25:04 Including analyzers: default\n[gosec] 2025/12/01 11:25:04 Excluding analyzers: default\n[gosec] 2025/12/01 11:25:04 Import directory: /tmp/go_synthesis_yvjkz9tm\n[gosec] 2025/12/01 11:25:04 Checking package: main\n[gosec] 2025/12/01 11:25:04 Checking file: /tmp/go_synthesis_yvjkz9tm/main.go"
                },
                {
                    "verifier": "staticcheck",
                    "error": "main.go:27:2: field activeWorkers is unused (U1000)\nmain.go:28:2: field activeWorkersMu is unused (U1000)"
                }
            ]
        },
        {
            "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"sync\"\n\t\"time\"\n)\n\ntype ResourceUpdate struct {\n\tResourceType string\n\tResourceID   string\n\tUsageValue   float64\n}\n\ntype ResourceMonitor struct {\n\thighPriorityQueue chan ResourceUpdate\n\tlowPriorityQueue  chan ResourceUpdate\n\tresources         map[string]map[string]float64\n\tresourcesMu       sync.RWMutex\n\tmonitoredTypes    map[string]bool\n\ttypesMu           sync.RWMutex\n\tworkerWg          sync.WaitGroup\n\tstopChan          chan struct{}\n\treconfigMu        sync.Mutex\n\tisPaused          bool\n\tpauseCond         *sync.Cond\n}\n\nfunc NewResourceMonitor(initialTypes []string, queueSize int) *ResourceMonitor {\n\trm := &ResourceMonitor{\n\t\thighPriorityQueue: make(chan ResourceUpdate, queueSize),\n\t\tlowPriorityQueue:  make(chan ResourceUpdate, queueSize),\n\t\tresources:         make(map[string]map[string]float64),\n\t\tmonitoredTypes:    make(map[string]bool),\n\t\tstopChan:          make(chan struct{}),\n\t\tisPaused:          false,\n\t}\n\n\trm.pauseCond = sync.NewCond(&rm.reconfigMu)\n\n\tfor _, t := range initialTypes {\n\t\trm.monitoredTypes[t] = true\n\t\trm.resources[t] = make(map[string]float64)\n\t}\n\n\treturn rm\n}\n\nfunc (rm *ResourceMonitor) StartWorkers(workersPerQueue int) {\n\tfor i := 0; i < workersPerQueue; i++ {\n\t\trm.workerWg.Add(1)\n\t\tgo rm.highPriorityWorker(i)\n\t}\n\n\tfor i := 0; i < workersPerQueue; i++ {\n\t\trm.workerWg.Add(1)\n\t\tgo rm.lowPriorityWorker(i)\n\t}\n\n\tfmt.Printf(\"Started %d high-priority workers and %d low-priority workers\\n\", workersPerQueue, workersPerQueue)\n}\n\nfunc (rm *ResourceMonitor) highPriorityWorker(id int) {\n\tdefer rm.workerWg.Done()\n\n\tfor {\n\t\tselect {\n\t\tcase <-rm.stopChan:\n\t\t\tfmt.Printf(\"High-priority worker %d shutting down\\n\", id)\n\t\t\treturn\n\t\tcase update := <-rm.highPriorityQueue:\n\t\t\trm.waitForReconfiguration()\n\t\t\trm.processUpdate(update, id, \"high-priority\")\n\t\t}\n\t}\n}\n\nfunc (rm *ResourceMonitor) lowPriorityWorker(id int) {\n\tdefer rm.workerWg.Done()\n\n\tfor {\n\t\tselect {\n\t\tcase <-rm.stopChan:\n\t\t\tfmt.Printf(\"Low-priority worker %d shutting down\\n\", id)\n\t\t\treturn\n\t\tcase update := <-rm.lowPriorityQueue:\n\t\t\trm.waitForReconfiguration()\n\t\t\trm.processUpdate(update, id, \"low-priority\")\n\t\t}\n\t}\n}\n\nfunc (rm *ResourceMonitor) waitForReconfiguration() {\n\trm.reconfigMu.Lock()\n\tfor rm.isPaused {\n\t\trm.pauseCond.Wait()\n\t}\n\trm.reconfigMu.Unlock()\n}\n\nfunc (rm *ResourceMonitor) processUpdate(update ResourceUpdate, workerID int, priority string) {\n\trm.typesMu.RLock()\n\tisMonitored := rm.monitoredTypes[update.ResourceType]\n\trm.typesMu.RUnlock()\n\n\tif !isMonitored {\n\t\tfmt.Printf(\"Ignoring update for unmonitored resource type: %s (worker %s-%d)\\n\",\n\t\t\tupdate.ResourceType, priority, workerID)\n\t\treturn\n\t}\n\n\trm.resourcesMu.Lock()\n\tif _, exists := rm.resources[update.ResourceType]; !exists {\n\t\trm.resources[update.ResourceType] = make(map[string]float64)\n\t}\n\trm.resources[update.ResourceType][update.ResourceID] = update.UsageValue\n\trm.resourcesMu.Unlock()\n\n\tfmt.Printf(\"[%s-worker-%d] Recorded %s:%s = %.2f%%\\n\",\n\t\tpriority, workerID, update.ResourceType, update.ResourceID, update.UsageValue)\n}\n\nfunc (rm *ResourceMonitor) SubmitHighPriorityUpdate(update ResourceUpdate) bool {\n\tselect {\n\tcase rm.highPriorityQueue <- update:\n\t\treturn true\n\tcase <-rm.stopChan:\n\t\treturn false\n\tdefault:\n\t\tfmt.Printf(\"High-priority queue full, skipping update for %s:%s\\n\",\n\t\t\tupdate.ResourceType, update.ResourceID)\n\t\treturn false\n\t}\n}\n\nfunc (rm *ResourceMonitor) SubmitLowPriorityUpdate(update ResourceUpdate) bool {\n\tselect {\n\tcase rm.lowPriorityQueue <- update:\n\t\treturn true\n\tcase <-rm.stopChan:\n\t\treturn false\n\tdefault:\n\t\tfmt.Printf(\"Low-priority queue full, skipping update for %s:%s\\n\",\n\t\t\tupdate.ResourceType, update.ResourceID)\n\t\treturn false\n\t}\n}\n\nfunc (rm *ResourceMonitor) Reconfigure(newTypes []string) {\n\tfmt.Println(\"\\n=== Starting reconfiguration ===\")\n\trm.reconfigMu.Lock()\n\trm.isPaused = true\n\trm.reconfigMu.Unlock()\n\n\ttime.Sleep(100 * time.Millisecond)\n\n\trm.typesMu.Lock()\n\trm.monitoredTypes = make(map[string]bool)\n\trm.resources = make(map[string]map[string]float64)\n\tfor _, t := range newTypes {\n\t\trm.monitoredTypes[t] = true\n\t\trm.resources[t] = make(map[string]float64)\n\t}\n\tfmt.Printf(\"Reconfigured to monitor: %v\\n\", newTypes)\n\trm.typesMu.Unlock()\n\n\trm.reconfigMu.Lock()\n\trm.isPaused = false\n\trm.pauseCond.Broadcast()\n\trm.reconfigMu.Unlock()\n\tfmt.Println(\"=== Reconfiguration complete, workers resumed ===\\n\")\n}\n\nfunc (rm *ResourceMonitor) Shutdown() {\n\tfmt.Println(\"\\nInitiating graceful shutdown...\")\n\tclose(rm.stopChan)\n\trm.workerWg.Wait()\n\tfmt.Println(\"All workers have shut down\")\n}\n\nfunc (rm *ResourceMonitor) GetResourceSnapshot() map[string]map[string]float64 {\n\trm.resourcesMu.RLock()\n\tdefer rm.resourcesMu.RUnlock()\n\n\tsnapshot := make(map[string]map[string]float64)\n\tfor resType, resources := range rm.resources {\n\t\tsnapshot[resType] = make(map[string]float64)\n\t\tfor resID, value := range resources {\n\t\t\tsnapshot[resType][resID] = value\n\t\t}\n\t}\n\treturn snapshot\n}\n\nfunc main() {\n\tfmt.Println(\"Resource Monitor with Dynamic Configuration Updates\")\n\tfmt.Println(\"=====================================================\\n\")\n\n\tinitialConfig := []string{\"CPU\", \"Memory\", \"Disk\"}\n\tmonitor := NewResourceMonitor(initialConfig, 20)\n\tmonitor.StartWorkers(5)\n\n\ttime.Sleep(500 * time.Millisecond)\n\n\tfmt.Println(\"--- Submitting initial resource updates ---\")\n\tresourceTypesInitial := []string{\"CPU\", \"Memory\", \"Disk\"}\n\tfor i := 0; i < 15; i++ {\n\t\tresourceType := resourceTypesInitial[i%len(resourceTypesInitial)]\n\t\tresourceID := fmt.Sprintf(\"%s-%d\", resourceType, i/3)\n\t\tusageValue := float64(20+i*3) / 100\n\n\t\tif i%3 == 0 {\n\t\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t} else {\n\t\t\tmonitor.SubmitLowPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t}\n\t}\n\n\ttime.Sleep(1 * time.Second)\n\n\tfmt.Println(\"--- Snapshot after initial updates ---\")\n\tsnapshot := monitor.GetResourceSnapshot()\n\tfor resType, resources := range snapshot {\n\t\tfor resID, value := range resources {\n\t\t\tfmt.Printf(\"  %s:%s = %.2f%%\\n\", resType, resID, value)\n\t\t}\n\t}\n\n\tfmt.Println(\"\\n--- Submitting updates including unmonitored 'Network' type ---\")\n\tfor i := 0; i < 5; i++ {\n\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\tResourceType: \"Network\",\n\t\t\tResourceID:   fmt.Sprintf(\"eth%d\", i),\n\t\t\tUsageValue:   float64(30 + i*5),\n\t\t})\n\t}\n\n\ttime.Sleep(500 * time.Millisecond)\n\n\tnewConfig := []string{\"Memory\", \"Network\", \"Disk\"}\n\tmonitor.Reconfigure(newConfig)\n\n\tfmt.Println(\"--- Submitting updates after reconfiguration ---\")\n\tresourceTypesNew := []string{\"Memory\", \"Network\", \"Disk\"}\n\tfor i := 0; i < 10; i++ {\n\t\tresourceType := resourceTypesNew[i%len(resourceTypesNew)]\n\t\tresourceID := fmt.Sprintf(\"%s-new-%d\", resourceType, i)\n\t\tusageValue := float64(40+i*2) / 100\n\n\t\tif i%2 == 0 {\n\t\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t} else {\n\t\t\tmonitor.SubmitLowPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t}\n\t}\n\n\ttime.Sleep(1 * time.Second)\n\n\tfmt.Println(\"--- Final snapshot after reconfiguration and additional updates ---\")\n\tfinalSnapshot := monitor.GetResourceSnapshot()\n\tfor resType, resources := range finalSnapshot {\n\t\tfmt.Printf(\"%s:\\n\", resType)\n\t\tfor resID, value := range resources {\n\t\t\tfmt.Printf(\"  %s = %.2f%%\\n\", resID, value)\n\t\t}\n\t}\n\n\tmonitor.Shutdown()\n\tfmt.Println(\"\\nProgram complete\")\n}",
            "passed": false,
            "errors": [
                {
                    "verifier": "gosec",
                    "error": "Results:\n\n\n[\u001b[37;40m/tmp/go_synthesis_yvjkz9tm/main.go:254\u001b[0m] - G602 (CWE-118): slice index out of range (Confidence: HIGH, Severity: LOW)\n    253: \tfor i := 0; i < 10; i++ {\n  > 254: \t\tresourceType := resourceTypesNew[i%len(resourceTypesNew)]\n    255: \t\tresourceID := fmt.Sprintf(\"%s-new-%d\", resourceType, i)\n\nAutofix: \n\n[\u001b[37;40m/tmp/go_synthesis_yvjkz9tm/main.go:208\u001b[0m] - G602 (CWE-118): slice index out of range (Confidence: HIGH, Severity: LOW)\n    207: \tfor i := 0; i < 15; i++ {\n  > 208: \t\tresourceType := resourceTypesInitial[i%len(resourceTypesInitial)]\n    209: \t\tresourceID := fmt.Sprintf(\"%s-%d\", resourceType, i/3)\n\nAutofix: \n\n\u001b[1;36mSummary:\u001b[0m\n  Gosec  : dev\n  Files  : 1\n  Lines  : 286\n  Nosec  : 0\n  Issues : \u001b[1;31m2\u001b[0m\n\n[gosec] 2025/12/01 11:25:22 Including rules: default\n[gosec] 2025/12/01 11:25:22 Excluding rules: default\n[gosec] 2025/12/01 11:25:22 Including analyzers: default\n[gosec] 2025/12/01 11:25:22 Excluding analyzers: default\n[gosec] 2025/12/01 11:25:22 Import directory: /tmp/go_synthesis_yvjkz9tm\n[gosec] 2025/12/01 11:25:22 Checking package: main\n[gosec] 2025/12/01 11:25:22 Checking file: /tmp/go_synthesis_yvjkz9tm/main.go"
                }
            ]
        },
        {
            "code": "package main\n\nimport (\n\t\"fmt\"\n\t\"sync\"\n\t\"time\"\n)\n\ntype ResourceUpdate struct {\n\tResourceType string\n\tResourceID   string\n\tUsageValue   float64\n}\n\ntype ResourceMonitor struct {\n\thighPriorityQueue chan ResourceUpdate\n\tlowPriorityQueue  chan ResourceUpdate\n\tresources         map[string]map[string]float64\n\tresourcesMu       sync.RWMutex\n\tmonitoredTypes    map[string]bool\n\ttypesMu           sync.RWMutex\n\tworkerWg          sync.WaitGroup\n\tstopChan          chan struct{}\n\treconfigMu        sync.Mutex\n\tisPaused          bool\n\tpauseCond         *sync.Cond\n}\n\nfunc NewResourceMonitor(initialTypes []string, queueSize int) *ResourceMonitor {\n\trm := &ResourceMonitor{\n\t\thighPriorityQueue: make(chan ResourceUpdate, queueSize),\n\t\tlowPriorityQueue:  make(chan ResourceUpdate, queueSize),\n\t\tresources:         make(map[string]map[string]float64),\n\t\tmonitoredTypes:    make(map[string]bool),\n\t\tstopChan:          make(chan struct{}),\n\t\tisPaused:          false,\n\t}\n\n\trm.pauseCond = sync.NewCond(&rm.reconfigMu)\n\n\tfor _, t := range initialTypes {\n\t\trm.monitoredTypes[t] = true\n\t\trm.resources[t] = make(map[string]float64)\n\t}\n\n\treturn rm\n}\n\nfunc (rm *ResourceMonitor) StartWorkers(workersPerQueue int) {\n\tfor i := 0; i < workersPerQueue; i++ {\n\t\trm.workerWg.Add(1)\n\t\tgo rm.highPriorityWorker(i)\n\t}\n\n\tfor i := 0; i < workersPerQueue; i++ {\n\t\trm.workerWg.Add(1)\n\t\tgo rm.lowPriorityWorker(i)\n\t}\n\n\tfmt.Printf(\"Started %d high-priority workers and %d low-priority workers\\n\", workersPerQueue, workersPerQueue)\n}\n\nfunc (rm *ResourceMonitor) highPriorityWorker(id int) {\n\tdefer rm.workerWg.Done()\n\n\tfor {\n\t\tselect {\n\t\tcase <-rm.stopChan:\n\t\t\tfmt.Printf(\"High-priority worker %d shutting down\\n\", id)\n\t\t\treturn\n\t\tcase update := <-rm.highPriorityQueue:\n\t\t\trm.waitForReconfiguration()\n\t\t\trm.processUpdate(update, id, \"high-priority\")\n\t\t}\n\t}\n}\n\nfunc (rm *ResourceMonitor) lowPriorityWorker(id int) {\n\tdefer rm.workerWg.Done()\n\n\tfor {\n\t\tselect {\n\t\tcase <-rm.stopChan:\n\t\t\tfmt.Printf(\"Low-priority worker %d shutting down\\n\", id)\n\t\t\treturn\n\t\tcase update := <-rm.lowPriorityQueue:\n\t\t\trm.waitForReconfiguration()\n\t\t\trm.processUpdate(update, id, \"low-priority\")\n\t\t}\n\t}\n}\n\nfunc (rm *ResourceMonitor) waitForReconfiguration() {\n\trm.reconfigMu.Lock()\n\tfor rm.isPaused {\n\t\trm.pauseCond.Wait()\n\t}\n\trm.reconfigMu.Unlock()\n}\n\nfunc (rm *ResourceMonitor) processUpdate(update ResourceUpdate, workerID int, priority string) {\n\trm.typesMu.RLock()\n\tisMonitored := rm.monitoredTypes[update.ResourceType]\n\trm.typesMu.RUnlock()\n\n\tif !isMonitored {\n\t\tfmt.Printf(\"Ignoring update for unmonitored resource type: %s (worker %s-%d)\\n\",\n\t\t\tupdate.ResourceType, priority, workerID)\n\t\treturn\n\t}\n\n\trm.resourcesMu.Lock()\n\tif _, exists := rm.resources[update.ResourceType]; !exists {\n\t\trm.resources[update.ResourceType] = make(map[string]float64)\n\t}\n\trm.resources[update.ResourceType][update.ResourceID] = update.UsageValue\n\trm.resourcesMu.Unlock()\n\n\tfmt.Printf(\"[%s-worker-%d] Recorded %s:%s = %.2f%%\\n\",\n\t\tpriority, workerID, update.ResourceType, update.ResourceID, update.UsageValue)\n}\n\nfunc (rm *ResourceMonitor) SubmitHighPriorityUpdate(update ResourceUpdate) bool {\n\tselect {\n\tcase rm.highPriorityQueue <- update:\n\t\treturn true\n\tcase <-rm.stopChan:\n\t\treturn false\n\tdefault:\n\t\tfmt.Printf(\"High-priority queue full, skipping update for %s:%s\\n\",\n\t\t\tupdate.ResourceType, update.ResourceID)\n\t\treturn false\n\t}\n}\n\nfunc (rm *ResourceMonitor) SubmitLowPriorityUpdate(update ResourceUpdate) bool {\n\tselect {\n\tcase rm.lowPriorityQueue <- update:\n\t\treturn true\n\tcase <-rm.stopChan:\n\t\treturn false\n\tdefault:\n\t\tfmt.Printf(\"Low-priority queue full, skipping update for %s:%s\\n\",\n\t\t\tupdate.ResourceType, update.ResourceID)\n\t\treturn false\n\t}\n}\n\nfunc (rm *ResourceMonitor) Reconfigure(newTypes []string) {\n\tfmt.Println(\"\\n=== Starting reconfiguration ===\")\n\trm.reconfigMu.Lock()\n\trm.isPaused = true\n\trm.reconfigMu.Unlock()\n\n\ttime.Sleep(100 * time.Millisecond)\n\n\trm.typesMu.Lock()\n\trm.monitoredTypes = make(map[string]bool)\n\trm.resources = make(map[string]map[string]float64)\n\tfor _, t := range newTypes {\n\t\trm.monitoredTypes[t] = true\n\t\trm.resources[t] = make(map[string]float64)\n\t}\n\tfmt.Printf(\"Reconfigured to monitor: %v\\n\", newTypes)\n\trm.typesMu.Unlock()\n\n\trm.reconfigMu.Lock()\n\trm.isPaused = false\n\trm.pauseCond.Broadcast()\n\trm.reconfigMu.Unlock()\n\tfmt.Println(\"=== Reconfiguration complete, workers resumed ===\\n\")\n}\n\nfunc (rm *ResourceMonitor) Shutdown() {\n\tfmt.Println(\"\\nInitiating graceful shutdown...\")\n\tclose(rm.stopChan)\n\trm.workerWg.Wait()\n\tfmt.Println(\"All workers have shut down\")\n}\n\nfunc (rm *ResourceMonitor) GetResourceSnapshot() map[string]map[string]float64 {\n\trm.resourcesMu.RLock()\n\tdefer rm.resourcesMu.RUnlock()\n\n\tsnapshot := make(map[string]map[string]float64)\n\tfor resType, resources := range rm.resources {\n\t\tsnapshot[resType] = make(map[string]float64)\n\t\tfor resID, value := range resources {\n\t\t\tsnapshot[resType][resID] = value\n\t\t}\n\t}\n\treturn snapshot\n}\n\nfunc main() {\n\tfmt.Println(\"Resource Monitor with Dynamic Configuration Updates\")\n\tfmt.Println(\"=====================================================\\n\")\n\n\tinitialConfig := []string{\"CPU\", \"Memory\", \"Disk\"}\n\tmonitor := NewResourceMonitor(initialConfig, 20)\n\tmonitor.StartWorkers(5)\n\n\ttime.Sleep(500 * time.Millisecond)\n\n\tfmt.Println(\"--- Submitting initial resource updates ---\")\n\tresourceTypesInitial := []string{\"CPU\", \"Memory\", \"Disk\"}\n\tfor i := 0; i < 15; i++ {\n\t\tif len(resourceTypesInitial) == 0 {\n\t\t\tbreak\n\t\t}\n\t\tresourceType := resourceTypesInitial[i%len(resourceTypesInitial)]\n\t\tresourceID := fmt.Sprintf(\"%s-%d\", resourceType, i/3)\n\t\tusageValue := float64(20+i*3) / 100\n\n\t\tif i%3 == 0 {\n\t\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t} else {\n\t\t\tmonitor.SubmitLowPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t}\n\t}\n\n\ttime.Sleep(1 * time.Second)\n\n\tfmt.Println(\"--- Snapshot after initial updates ---\")\n\tsnapshot := monitor.GetResourceSnapshot()\n\tfor resType, resources := range snapshot {\n\t\tfor resID, value := range resources {\n\t\t\tfmt.Printf(\"  %s:%s = %.2f%%\\n\", resType, resID, value)\n\t\t}\n\t}\n\n\tfmt.Println(\"\\n--- Submitting updates including unmonitored 'Network' type ---\")\n\tfor i := 0; i < 5; i++ {\n\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\tResourceType: \"Network\",\n\t\t\tResourceID:   fmt.Sprintf(\"eth%d\", i),\n\t\t\tUsageValue:   float64(30 + i*5),\n\t\t})\n\t}\n\n\ttime.Sleep(500 * time.Millisecond)\n\n\tnewConfig := []string{\"Memory\", \"Network\", \"Disk\"}\n\tmonitor.Reconfigure(newConfig)\n\n\tfmt.Println(\"--- Submitting updates after reconfiguration ---\")\n\tresourceTypesNew := []string{\"Memory\", \"Network\", \"Disk\"}\n\tfor i := 0; i < 10; i++ {\n\t\tif len(resourceTypesNew) == 0 {\n\t\t\tbreak\n\t\t}\n\t\tresourceType := resourceTypesNew[i%len(resourceTypesNew)]\n\t\tresourceID := fmt.Sprintf(\"%s-new-%d\", resourceType, i)\n\t\tusageValue := float64(40+i*2) / 100\n\n\t\tif i%2 == 0 {\n\t\t\tmonitor.SubmitHighPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t} else {\n\t\t\tmonitor.SubmitLowPriorityUpdate(ResourceUpdate{\n\t\t\t\tResourceType: resourceType,\n\t\t\t\tResourceID:   resourceID,\n\t\t\t\tUsageValue:   usageValue,\n\t\t\t})\n\t\t}\n\t}\n\n\ttime.Sleep(1 * time.Second)\n\n\tfmt.Println(\"--- Final snapshot after reconfiguration and additional updates ---\")\n\tfinalSnapshot := monitor.GetResourceSnapshot()\n\tfor resType, resources := range finalSnapshot {\n\t\tfmt.Printf(\"%s:\\n\", resType)\n\t\tfor resID, value := range resources {\n\t\t\tfmt.Printf(\"  %s = %.2f%%\\n\", resID, value)\n\t\t}\n\t}\n\n\tmonitor.Shutdown()\n\tfmt.Println(\"\\nProgram complete\")\n}",
            "passed": true,
            "errors": []
        }
    ],
    "passed": true
}