题目：实现一个支持按表名获取与释放租约（lease）的表元数据管理组件

在一个分布式 SQL 数据库中，每个表都有一个称为 lease 的结构，用于表示某事务或查询持有该表元数据的一个有效版本。Lease 管理器需要负责分配、引用计数、缓存和自动清理这些 lease。

请设计并实现一个简化的 Lease 管理系统，满足如下功能性需求：

🔹 1. Lease 的基本结构

系统需要管理多个 LeaseState 对象，每个 lease 至少包含：

表 ID

表名

表的版本号

当前引用计数 refcount

是否已经被标记为不可继续使用（如表删除后）

系统应提供安全的方式增加与减少引用计数。

🔹 2. 按表名获取 Lease（AcquireByName）

实现一个接口根据 (dbID, tableName) 返回对应表的有效 lease：

若缓存中已有该表的 lease，则增加引用计数并返回它。

若缓存中没有，则从底层 LeaseStore 中获取最新 lease，将其加入缓存并返回。

如果表不存在或已被删除，需返回错误或空。

🔹 3. 释放 Lease（Release）

实现 lease 的释放逻辑：

释放一个 lease 时应递减其引用计数。

当引用计数降为 0 时，需要判断该 lease 是否应立即从系统中移除。

移除的规则包括但不限于：

该表已删除（此表不再需要任何 lease）

该 lease 不再是该表的最新版本（旧版本不可再被获取）

当 lease 被移除时：

从缓存移除

通知 LeaseStore 做进一步清理（可异步执行）

🔹 4. 表名缓存（tableNameCache）

实现一个缓存结构，用于加速按表名查找 lease：

支持插入、查询、删除 lease

当 lease 不再有效（见释放规则），应当从缓存中移除

🔹 5. 表状态结构（tableState）

每个表 ID 对应一个 tableState，需负责：

管理该表的当前所有 lease 列表（不同版本可能并存）

记录该表是否已被标记为“已删除”

为 Acquire/Release 函数提供辅助方法，如查找最新版本 lease

🔹 6. LeaseStore（底层获取 Lease）

实现一个简单的 LeaseStore：

支持从存储中获取给定表的最新 lease

支持在 lease 被回收时执行相应操作（可模拟）

🔹 7. 场景需求：AcquireByName 与 Release 可能并发发生

你的实现需要确保以下场景的行为正确：

同一个 lease 可能在被释放的同时，又被其他事务按表名获取

若表在此期间被标记为删除：

释放后的 lease 不应再保留在缓存中

AcquireByName 不应返回被删除表的 lease

多轮 Acquire ↔ Release 交替操作应行为一致

不要求实现锁，只需保证功能处理逻辑合理且不会出现状态错误（如负 refcount、重复删除、泄漏 lease 等）。

🔹 8. 单元测试场景（需能通过）

你需要编写或支持一个测试类似的场景：

创建一个表并首次获取 lease（填充缓存）

释放一次该 lease

将该表标记为“已删除”

多次并发执行：

AcquireByName

Release

每次操作后应满足：

引用计数正确

废弃 lease 被清理

缓存与 lease 列表保持一致

测试中，Acquire 与 Release 的先后顺序不固定，因此实现需正确处理各种 interleaving 情况。