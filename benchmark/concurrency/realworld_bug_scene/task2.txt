Implement a lease management system in Go for a distributed SQL database where each table has a lease representing a valid version of its metadata. Each LeaseState includes table ID, table name, version number, reference count, and a deletion flag. The system must provide safe reference count increment and decrement operations.
The AcquireByName function should return a lease for a given (dbID, tableName) pair by either returning a cached lease with incremented refcount or fetching the latest lease from a LeaseStore backend, caching it, and returning it. The Release function should decrement refcount and, when it reaches zero, remove the lease if the table is deleted or the lease is no longer the latest version. Removal involves evicting from cache and notifying LeaseStore for cleanup.
Implement a tableNameCache for fast lookups by table name and a tableState structure per table ID that manages all lease versions for that table, tracks deletion status, and provides helper methods for finding the latest version. The LeaseStore backend should support fetching the latest lease and handling cleanup operations.
The implementation must correctly handle concurrent AcquireByName and Release operations on the same lease without explicit locking. When a table is marked deleted, released leases must not remain cached and AcquireByName must not return leases for deleted tables. The system must prevent negative refcounts, duplicate deletions, and lease leaks while maintaining consistent cache and lease list states across arbitrary interleavings of acquire and release operations.